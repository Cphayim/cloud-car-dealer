<!--pages/client/client.wxml-->
<!-- 客户 -->

<!-- 组件引入 -->
<import src="../../../components/search/search.wxml" />
<import src="../../../components/selection/selection.wxml" />

<!-- 搜索入口 -->
<template is="search-outer" data="{{type:'client',url:'/pages/search/search'}}"></template>

<!-- 选项盒子组件 -->
<template wx:if="{{selection}}" is="selection" data="{{...selection}}"></template>

<!-- 滚动容器 -->
<scroll-view
  class=".m-client-scroll-view" style="height:{{clientScrollViewHeight}}px" 
  scroll-y scroll-into-view="{{scrollToId}}" scroll-top="1000" scroll-with-animation enable-back-to-top
  bindscroll="clientListScroll" >
  <!-- 客户列表 -->
  <view class="m-client section">
    <!-- 分级列表(列表循环) -->
    <block wx:for="{{clientData}}" wx:for-item="listObj" wx:key="level">
      <view id="{{listObj.level}}" class="client-list" data-client-level="{{listObj.level}}">
        <view class="title">{{listObj.level}}级：{{listObj.clientList.length}}</view>
        <!-- 客户（列表循环） -->
        <block wx:for="{{listObj.clientList}}" wx:for-item="client" wx:key="id">
          <navigator url="{{pagePath.customer}}" class="item" data-client-id="client.id">
            <view class="l">
              <image class="avatar" src="{{client.avatarUrl}}"></image>
            </view>
            <view class="c">
              <view class="namewrap">
                <view class="realname">{{client.realname}}</view>
                <view class="username">{{client.username}}</view>
              </view>
              <!-- 签名 -->
              <view class="signature">{{client.signature}}</view>
            </view>
            <view class="r">
              <view class="time">{{client.time}}</view>
            </view>
          </navigator>
        </block>
      </view>
    </block>
  </view>
</scroll-view>

<!-- 侧栏导航 -->
<view catchtap="scrollToList" class="m-side-nav {{scrolling?'active':''}}">
  <block wx:for="{{clientData}}" wx:for-item="listObj" wx:key="level">
    <view class="item" data-level-id="{{listObj.level}}">{{listObj.level}}</view>
  </block>
</view>